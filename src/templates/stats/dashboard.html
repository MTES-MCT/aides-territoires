{% extends "_base.html" %}
{% load humanize compress form_utils settings static %}

{% block extratitle %}Dashboard Interne{% endblock extratitle %}

{% block extra_head %}
  <script src="{% static 'chartist/dist/chartist.min.js' %}"></script>
  <script src="{% static 'chartist-plugin-fill-donut/dist/chartist-plugin-fill-donut.js' %}"></script>
  <script src="{% static 'js/stats/chartist-plugin-tooltip.js' %}"></script>
  <link rel="stylesheet" href="{% static 'chartist/dist/chartist.css' %}" />
  <link rel="stylesheet" href="{% static 'js/stats/chartist-plugin-tooltip.css' %}" />
  <link rel="stylesheet" href="{% static 'css/stats.css' %}" />
{% endblock extra_head %}

{% block content %}
<section id="stats" class="fr-container">
  <h2 class="fr-mt-0w">Statistiques globales :</h2>
  <div class="fr-container">
    <div class="fr-grid-row fr-mb-2w fr-pt-0w fr-p-0w fr-grid-row--center fr-grid-row--gutter fr-pb-3w fr-pt-2w fr-centered fr-grid-row--bottom">
        <div class="fr-col-12 fr-col-lg-12 fr-p-2w">
        <div role="alert" class="fr-alert fr-alert--success fr-alert--sm fr-mb-2w fr-grid--center">
          <p class="fr-text--lg"><b><a href="{% url 'users_stats' %}">{{ nb_beneficiary_accounts|intcomma }} comptes utilisateurs</a></b>, répartis en <b><a href="{% url 'organizations_stats' %}">{{ nb_organizations|intcomma }} structures</a></b>, ont créé <b><a href="{% url 'projects_stats' %}">{{ nb_projects|intcomma }} projets</a></b>
            avec en tout <b>{{ nb_aids_matching_projects }} aides sélectionnées</b> sur un total de <b>{{ nb_aids_live|intcomma }} aides disponibles</b> publiées par <b>{{ nb_active_financers|intcomma }} porteurs</b>.
            Sont également disponibles <b>{{ nb_searchPage|intcomma }} portails</b>.
          <br /><span class="fr-hint-text">Pour rappel, le compte utilisateur a été lancé le 4 novembre 2021.</span>
          </p>
        </div>
      </div>
    </div>

    <h2 class="fr-mt-5w">🌱 Objectifs collectivités :</h2>

    <div class="charts" style="margin-bottom: -160px;">
      <div id="chart-communes" class="ct-chart"></div>
      <div id="chart-epci" class="ct-chart"></div>
    </div>
    <div class="charts-legends">
      <ul>
        <li><span class="charts-legend charts-legend-accent"></span> Territoires inscrits</li>
        <li><span class="charts-legend charts-legend-regular"></span> Objectif 2022</li>
        <li><span class="charts-legend charts-legend-minor"></span> Reste</li>
      </ul>
    </div>

    <script>
      new Chartist.Pie('#chart-communes', {
        series: [
          {{ nb_communes }},
          {{ objectif_communes }}-{{ nb_communes }}-150,
          300, // This fake value is responsible for the goal bar.
          {{ total_communes }}-{{ objectif_communes }}+150-300
        ]
      }, {
        donut: true,
        donutWidth: 60,
        donutSolid: true,
        startAngle: 270,
        total: {{ total_communes }} * 2,
        showLabel: false,
        plugins: [
          Chartist.plugins.fillDonut({
            items: [{
              content: '<p><strong><a href="{% url 'carto_stats' %}">{{ nb_communes }} communes / {{ total_communes }}</a></strong><br>Objectif : 10&#8239;000 <span class="charts-legend charts-legend-regular"></span></p>',
              offsetY: -20
            }]
          })
        ]
      })
      new Chartist.Pie('#chart-epci', {
        series: [
          {{ nb_epci }},
          {{ objectif_epci }}-{{ nb_epci }}-5,
          10, // This fake value is responsible for the goal bar.
          {{ total_epci }}-{{ objectif_epci }}+5-10
        ]
      }, {
        donut: true,
        donutWidth: 60,
        donutSolid: true,
        startAngle: 270,
        total: {{ total_epci }} * 2,
        showLabel: false,
        plugins: [
          Chartist.plugins.fillDonut({
            items: [{
              content: '<p><strong>{{ nb_epci }} EPCI ({{ pourcent_epci }}%)</strong><br>Objectif : 75% <span class="charts-legend charts-legend-regular"></span></p>',
              offsetY: -20
            }]
          })
        ]
      })
    </script>
  </div>

  <div class="fr-mt-5w fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-mb-5w">
    <h4 class="fr-mt-0w">Statistiques sur une période :</h4>
      <div class="fr-col-12 fr-col-md-6 fr-mt-4w">
        <form method="get" action="{% url 'dashboard_view' %}" class="fr-grid-row fr-grid-row--start">

          <div id="form-group-start_date" class="fr-input-group fr-mb-0">
            <div class="fr-input-wrap fr-icon-calendar-line">
              <label for="id_start_date" class="fr-label"></label>
              <input type="date" name="start_date" {% if request.GET.start_date %} value="{{ request.GET.start_date }}" {% else %} value="{% now 'Y-m-d' %}" {% endif %} required="" id="id_start_date" class="fr-input fr-mt-0" />
              <span class="fr-hint-text">Date de début</span>
            </div>
          </div>

          <div id="form-group-end_date" class="fr-input-group fr-mb-0">
            <div class="fr-input-wrap fr-icon-calendar-line">
              <label for="id_end_date" class="fr-label"></label>
              <input type="date" name="end_date" {% if request.GET.end_date %} value="{{ request.GET.end_date }}" {% else %} value="{% now 'Y-m-d' %}" {% endif %} required="" id="id_end_date" class="fr-input fr-mt-0" />
              <span class="fr-hint-text">Date de fin</span>
            </div>
          </div>
        
          <div>
            <button type="submit" class="fr-btn">Envoyer</button>
          </div>
          
          {% if start_date_error %}
          <span class="error field-error">
            ↑
            {{ start_date_error.0 }}
            ↑
          </span>
          {% endif %}
        </form>
    </div>
  </div>

  <div class="fr-container fr-mb-5w">

    <h5 class="fr-mt-2w">Consultation :</h5>
    <div  class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link" >
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                  Nombre de visiteurs
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_visits|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Taux de rebond</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ bounce_rate }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                  Durée moyenne d’une visite
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ avg_time_on_site }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                  Nombre de pages vues
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_pageviews|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                Nombre d’aides vues
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_viewed_aids|intcomma }}</b></p>
            </div>
          </div>
        </div>
    </div>

    <h5 class="fr-mt-5w">🚀 Visites uniques hebdomadaires <span class="charts-legend charts-legend-accent"></span> vs. inscriptions (⨯50) <span class="charts-legend charts-legend-regular"></span> :</h5>
    <div class="charts">
      <div id="chart-visites-uniques" class="ct-chart"></div>
    </div>

    <script>
      new Chartist.Line('#chart-visites-uniques', {
        labels: {{ nb_vu_weeks|safe }},
        series: [
          {{ nb_vu_serie_values }},
          // Change the scale to make it visible
          // and adapt meta for the tooltip content.
          {{ nb_inscriptions_serie }}.map(count => {
            return {value: count * 50, meta: count}
          })
        ]
      }, {
        fullWidth: true,
        chartPadding: {
          right: 40
        },
        axisX: {
          labelInterpolationFnc: function(value) {
            // Only display day/month (from ISO date).
            const [ month, day ] = value.slice(5, 10).split('-')
            return `${day}/${month}`
          }
        },
        axisY: {
          type: Chartist.AutoScaleAxis,
          high: {{ nb_vu_serie_max }} + 3000,
          low: 0,
        },
        plugins: [
          Chartist.plugins.tooltip({appendToBody: true})
        ]
      })
    </script>


    <h5 class="fr-mt-5w">Acquisition :</h5>
    <div  class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Entrées directes</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_direct_visitors|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Depuis les moteurs</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_searchEngine_visitors|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Depuis d’autres sites</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_webSite_visitors|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Depuis les newsletters</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_newsletter_visitors|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Depuis les réseaux sociaux</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_socialNetwork_visitors|intcomma }}</b></p>
            </div>
          </div>
        </div>
    </div>

    <h5 class="fr-mt-5w">🧲 Principales sources d’entrées :</h5>
    <div
      class="fr-table fr-table--layout-fixed fr-table--no-caption"
      data-controller="table"
      data-downloadable="true"
      >
      <table data-table-target="table">
        <caption>Principales sources d’entrées</caption>
        <thead>
          <tr>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="text"
              >Domaine</th>
            <th
              scope="col"
              aria-sort="descending"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="number"
              >Visites</th>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="number"
              >Pourcentage</th>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="number"
              >Pourcentage (sans la recherche)</th>
          </tr>
        </thead>
        <tbody data-table-target="body">
          {% for label, counts in referrers.items %}
          <tr data-table-target="row">
            <td scope="row">{{ label }}</td>
            <td>{{ counts.0 }}</td>
            <td>{{ counts.1 }}</td>
            <td>{{ counts.2 }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h5 class="fr-mt-5w">Engagement :</h5>
    <div  class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-md-2">
        <div class="fr-tile fr-enlarge-link">
          <div class="fr-tile__body">
            <p class="fr-tile__title">
              <a class="fr-tile__link" href="#">Nombre d’utilisateurs connectés/actifs</a>
            </p>
          </div>
          <div class="fr-tile__img overflow--initial" role="presentation">
            <p class="fr-text--lg"><b>0</b></p>
          </div>
        </div>
      </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                  Nombre de recherche
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_search_events|intcomma }}</b></p>
            </div>
          </div>
        </div>

        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                  Nombre d’alertes créées
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_alerts_created|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                Nombre de commentaires
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>-</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">
                Nombre de clics (+ de détails)
                </a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_aid_contact_click_events|intcomma }}</b></p>
            </div>
          </div>
        </div>
    </div>

    <h5 class="fr-mt-5w">
      🆕 Nombre d’inscriptions toutes structures confondues <span class="charts-legend charts-legend-accent"></span> :
    </h5>
    <div class="charts">
      <div id="chart-inscriptions" class="ct-chart"></div>
    </div>
    <div class="charts-legends">
      <ul>
        <li><span class="charts-legend charts-legend-regular"></span> Avec une aide publiée</li>
        <li><span class="charts-legend charts-legend-regular2"></span> Avec un projet</li>
        <li><span class="charts-legend charts-legend-regular3"></span> Alertes créées cette semaine</li>
      </ul>
    </div>

    <script>
      new Chartist.Bar('#chart-inscriptions', {
        labels: {{ nb_inscriptions_weeks|safe }},
        series: [
          {{ nb_inscriptions_serie }},
          {{ nb_inscriptions_with_created_aid_serie }},
          {{ nb_inscriptions_with_created_project_serie }},
          {{ nb_inscriptions_with_created_alert_serie }}
        ]
      }, {
        // stackBars: true,
        axisX: {
          labelInterpolationFnc: (value) => {
            // Only display day/month (from ISO date).
            const [ month, day ] = value.slice(5, 10).split('-')
            return `${day}/${month}`
          }
        },
        plugins: [
          Chartist.plugins.tooltip({appendToBody: true, pointClass: 'ct-bar'})
        ]
      })
    </script>

    <h5 class="fr-mt-5w">
      📍 Nombre d’inscriptions communes <span class="charts-legend charts-legend-accent"></span> :
    </h5>
    <div class="charts">
      <div id="chart-inscriptions-communes" class="ct-chart"></div>
    </div>
    <div class="charts-legends">
      <ul>
        <li><span class="charts-legend charts-legend-regular"></span> Avec une aide publiée</li>
        <li><span class="charts-legend charts-legend-regular2"></span> Avec un projet</li>
      </ul>
    </div>

    <script>
      new Chartist.Bar('#chart-inscriptions-communes', {
        labels: {{ nb_inscriptions_communes_weeks|safe }},
        series: [
          {{ nb_inscriptions_communes_serie }},
          {{ nb_inscriptions_communes_with_created_aid_serie }},
          {{ nb_inscriptions_communes_with_created_project_serie }}
        ]
      }, {
        // stackBars: true,
        axisX: {
          labelInterpolationFnc: (value) => {
            // Only display day/month (from ISO date).
            const [ month, day ] = value.slice(5, 10).split('-')
            return `${day}/${month}`
          }
        },
        plugins: [
          Chartist.plugins.tooltip({appendToBody: true, pointClass: 'ct-bar'})
        ]
      })
    </script>

    <h5 class="fr-mt-5w">🥇 Aides les plus populaires :</h5>
    <div
      class="fr-table fr-table--layout-fixed fr-table--no-caption"
      data-controller="table"
      data-downloadable="true"
      >
      <table data-table-target="table">
        <caption>Aides les plus populaires</caption>
        <thead>
          <tr>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="text"
              >Aide</th>
            <th
              scope="col"
              aria-sort="descending"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="number"
              >Visites</th>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="number"
              >Visites uniques</th>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="number"
              >Nombre de sauvegardes</th>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="text"
              >Périmètre</th>
            <th
              scope="col"
              data-action="click->table#sortTable"
              data-table-target="header"
              data-type="text"
              >Porteur</th>
          </tr>
        </thead>
        <tbody data-table-target="body">
          {% for aid_stats in top_aids_pages %}
            {% with has_aid=aid_stats.aid_or_name.get_absolute_url %}
            <tr data-table-target="row">
              <td {% if forloop.first %}scope="row"{% endif %}>
                {% if has_aid %}
                  <a href="{{ has_aid }}">
                    {{ aid_stats.aid_or_name }}
                  </a>
                {% else %}
                  {{ aid_stats.aid_or_name }}
                {% endif %}
              </td>
              <td>{{ aid_stats.nb_visits }}</td>
              <td>{{ aid_stats.nb_uniq_visitors }}</td>
              <td>
                {% if has_aid %}
                  {% with saved_count=aid_stats.aid_or_name.aidproject_count %}
                    {% if saved_count %}
                      {{ saved_count }}
                    {% else %}
                      -
                    {% endif %}
                  {% endwith %}
                {% else %}
                  -
                {% endif %}
              </td>
              <td>
                {% if has_aid %}
                  {{ aid_stats.aid_or_name.perimeter.name }}
                {% else %}
                  -
                {% endif %}
              </td>
              <td>
                {% if has_aid %}
                  {% with financers=aid_stats.aid_or_name.financers.all %}
                    {% if financers %}
                      <ul>
                        {% for financer in financers %}
                          <li>{{ financer }}</li>
                        {% endfor %}
                      </ul>
                    {% else %}
                      -
                    {% endif %}
                  {% endwith %}
                {% else %}
                  -
                {% endif %}
              </td>
            </tr>
            {% endwith %}
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h5 class="fr-mt-5w">Côté Porteurs de projets :</h5>
    <div  class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre de nouveaux comptes</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_beneficiary_accounts_created|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre de nouvelles structures</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_beneficiary_organizations|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre de nouveaux projets</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_projects_for_period|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre d’aides ajoutées dans des projets</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_aids_matching_projects_for_period|intcomma }}</b></p>
            </div>
          </div>
        </div>
    </div>

    <h5 class="fr-mt-5w">Côté Porteurs d’aides :</h5>
    <div  class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre de nouveaux comptes</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_contributor_accounts_created|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre de nouvelles structures</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_contributor_organizations|intcomma }}</b></p>
            </div>
          </div>
        </div>
        <div class="fr-col-12 fr-col-md-2">
          <div class="fr-tile fr-enlarge-link">
            <div class="fr-tile__body">
              <p class="fr-tile__title">
                <a class="fr-tile__link" href="#">Nombre de nouvelles aides publiées</a>
              </p>
            </div>
            <div class="fr-tile__img overflow--initial" role="presentation">
              <p class="fr-text--lg"><b>{{ nb_aids_live_for_period|intcomma }}</b></p>
            </div>
          </div>
        </div>
    </div>
  </div>
</section>
{% endblock content %}

{% block extra_js %}
<script type="module">
  import { Application } from "{% static '@hotwired/stimulus/dist/stimulus.js' %}"
  import tableController from "{% static 'js/stats/table_controller.js' %}"
  window.Stimulus = Application.start()
  {% setting "DEBUG" as Debug %}
  Stimulus.debug = {{ Debug|lower }}
  Stimulus.register("table", tableController)
</script>
{% endblock extra_js %}
