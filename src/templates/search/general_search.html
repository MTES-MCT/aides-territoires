{% extends "_base.html" %}
{% load i18n compress static dsfr_tags %}

{% block extratitle %}Recherche – Trouver des aides{% endblock extratitle %}

{% block extra_head %}
<meta property="og:title" content="Aides-territoires | Toutes les aides pour les acteurs locaux  🏡" />
<meta property="og:type" content="website" />
<meta property="og:description" content="Trouvez les aides pertinentes pour financer et accompagner les projets de votre territoire" />
<meta property="og:url" content="https://aides-territoires.beta.gouv.fr" />
<meta property="og:site_name" content="Aides-territoires" />
<meta property="og:image" content="https://aides-territoires.beta.gouv.fr/static/img/logo_AT_og.png" />
<meta property="og:image:alt" content="Logo : Aides-territoires" />
{% endblock extra_head %}

{% block sectionid %}search-steps{% endblock sectionid %}

{% block breadcrumbs %}
<div class="fr-container">
    <nav role="navigation" class="fr-breadcrumb" aria-label="vous êtes ici :">
        <button class="fr-breadcrumb__button" aria-expanded="false" aria-controls="breadcrumb-1">Voir le fil d’Ariane</button>
        <div class="fr-collapse" id="breadcrumb-1">
            <ol class="fr-breadcrumb__list">
                <li>
                    <a class="fr-breadcrumb__link" href="{% url 'home' %}">Accueil</a>
                </li>
                <li>
                    <a class="fr-breadcrumb__link" aria-current="page">Trouver des aides</a>
                </li>
            </ol>
        </div>
    </nav>
</div>
{% endblock breadcrumbs %}

{% block content %}
<div class="fr-container">
    <h1 class="fr-mb-5w fr-h2">Trouver des aides</h1>
    <form id="general_search_form" method="get" action="{% url 'search_view' %}" class="fr-px-0">        
        <h2 class="fr-h4 fr-mt-4w">
            <span class="counter">
                1
            </span> 
            Définissez votre périmètre
        </h2>
        <div class="fr-grid-row fr-grid-row--gutters fr-mt-4w">
            <div class="fr-select-group fr-col-12 fr-col-md-3 fr-pb-0 fr-mb-0">
                <h3 class="fr-h6">votre structure :</h3>
                <div id="form-group-targeted_audiences" class="fr-input-group">
                    <label for="id_targeted_audiences">Vous êtes un/une</label>
                    <select class="fr-select" name="targeted_audiences" id="id_targeted_audiences">
                        <option value="" hidden>Faites votre choix</option>
                        {% for option in form.targeted_audiences %}
                        {{ option }}
                        {% endfor %}
                        <option value="">Toutes structures confondues</option>
                    </select>
                </div>

            </div>
            <div class="fr-select-group fr-col-12 fr-col-md-6 fr-pb-0 fr-mb-0">
                <h3 class="fr-h6">votre territoire :</h3>
                {% include '_field_snippet.html' with field=form.perimeter %}
            </div>
            <div id="text-research-help" class="fr-mt-2w fr-ml-1w">
                <p><span>💡</span> Si vous laissez ces champs vides, votre recherche portera sur l’ensemble du territoire, toutes structures confondues.</p>
            </div>
        </div>

        <h2 class="fr-h4 fr-mt-4w"><span class="counter">2</span> Puis affinez votre recherche</h2>
        <div class="fr-grid-row fr-grid-row--gutters fr-mt-3w fr-mb-5w">
            <div class="fr-select-group fr-col-12 fr-col-md-6 fr-pr-2w column--space-between fr-mb-0" id="search-step-2">
                <div class="fr-container fr-p-0">
                    <h3 class="fr-h6">soit par mot-clé :
                        <div class="fr-hint-text">
                            recherchez parmi toutes les aides le mot-clé que vous souhaitez
                        </div>
                    </h3>
                    <div class="fr-grid-row fr-grid-row--middle">
                        <div class="fr-col-12 fr-col-md-8 fr-mr-1w">
                            {% dsfr_form_field form.text %}
                        </div>
                        <button name="action" value="search" type="submit" class="fr-btn fr-my-1w">
                            <span class="fr-fi-search-line fr-mr-1w" aria-hidden="true"></span>
                            Rechercher
                        </button>
                        <div class="fr-col-12 fr-col-md-12 fr-mr-1w">
                            <p class="fr-mb-0 fr-mt-2w fr-hint-text"><strong><span class="fr-text">💡</span> 3 astuces pour optimiser votre recherche :</strong></p>
                            <ul class="fr-hint-text">
                              <li class="fr-mx-2w">"piste cyclable" renverra les aides contenant les 2 termes "piste" et "cyclable".</li>
                              <li class="fr-mx-2w">"piste cyclable<strong>,</strong> voie douce" avec une virgule comme séparateur, renverra les aides contenant les 2 termes "piste" et "cyclable" ou les 2 termes "voie" et "douce".</li>
                              <li class="fr-mx-2w">Certains champs lexicaux liés au mot clé que vous tapez peuvent vous être proposé à la sélection. Si vous sélectionnez un champ lexical votre recherche sera effectuée sur tous les mots clés de ce champ lexical.</li>
                            </ul>
                        </div>
                    </div>    
                </div>
                <img src="{% static 'img/home_aides.svg' %}" alt="picto-aides-territoires" class="fr-responsive-img" />
            </div>
            <div class="fr-select-group fr-col-12 fr-col-md-6 fr-pl-2w" id="search-step-2">
                <h3 class="fr-h6">soit par thématiques :
                    <span class="fr-hint-text fr-mb-0">
                        cliquez sur une thématique, sélectionnez ensuite une ou plusieurs sous-thématiques
                    </span>
                </h3>
                <ul class="fr-accordions-group fr-pt-0" id="categories">
                    {% include '_field_snippet.html' with field=form.categories %}
                </ul>
                <button name="action" value="search" type="submit" class="fr-btn fr-mb-2w fr-mt-3w">
                    <span class="fr-fi-search-line fr-mr-1w" aria-hidden="true"></span>
                    Rechercher
                </button>
            </div>
        </div>            
    </form>        
</div>
{% endblock content %}

{% block extra_css %}
{% compress css %}
{% endcompress %}
{% endblock extra_css %}

{% block extra_js %}
{% compress js %}
<script src="{% static 'select2/dist/js/select2.js' %}"></script>
<script src="{% static 'select2/dist/js/i18n/fr.js' %}"></script>
<script src="{% static 'js/aids/perimeter_autocomplete.js' %}"></script>
<script src="{% static 'js/aids/text_autocomplete.js' %}"></script>
<script src="{% static 'js/aids/select2_dsfr.js' %}"></script>
<script src="{% static 'js/search/check_all_categories_btn.js' %}"></script>
<script src="{% static 'js/search/track_general_search_page_events.js' %}"></script>
{% endcompress %}
{% endblock extra_js %}
