{% extends '_base.html' %}
{% load compress %}
{% load i18n %}

{% block extratitle %}Recherche - Projet{% endblock %}

{% block sectionid %}search-steps{% endblock %}

{% block content %}
<div id="before-project-modal"></div>
<div id="project-modal" class="modal show" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <section>
            <header>
                <h1>Quel est votre projet&nbsp;?</h1>
            </header>

            <div class="content">
                <div class="info">
                    <p><strong>Indiquez le projet pour lequel vous recherchez une aide.</strong></p>
                    <p><strong>Cela nous permettra d'améliorer dans le futur la pertinence des résultats qui vous seront proposés.</strong></p>
                </div>
            
                {% if project_choices and categories_length %}
                <form id="projects" action="{% url 'search_view' %}" method="GET">
                
                    {% include '_form_snippet.html' %}
                
                    <button name="action" value="search" type="submit">
                        Envoyer
                    </button>         
                </form>

                <div class="warning">
                    <p>Ces informations n’auront aucune influence sur les résultats de votre recherche et resteront confidentielles</p>
                </div>  

                <div id="other_project_box" class="d-none">
                    <p>Aucun de ces projets ne correspond à votre recherche ? </p>
                    <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#suggested_project_box">Suggérer un projet</button>
                </div>
                
                <div id="suggested_project_box" class="collapse">
                {% else %}
                <div id="suggested_project_box">
                {% endif %}
                    <h3>Contribuez à améliorer Aides-territoires !</h3>
                    <div class="info">
                        <p>Indiquez le projet pour lequel vous recherchez une aide.</p>
                        <p>Cela nous permettra d'améliorer dans le futur la pertinence des résultats qui vous seront proposés.</p>
                    </div>
                    <form id="suggested_project" method="post" action="{% url 'project_suggest_view' %}?{{ querystring }}">
                        <div class="content">
                            {% csrf_token %}
                            {% include '_field_snippet.html' with field=project_form.name %}
                            {% include '_field_snippet.html' with field=project_form.description %}
                            <button name="action" value="search" type="submit">
                                Partager mon projet et accéder aux aides disponibles
                            </button>
                        </div>
                    </form>
                </div>   
            </div>

            <div class="modal-footer">
                <div class="navigation-links">
                    <a class="previous-btn" href="{% url 'search_step_category' %}?{{ querystring }}">
                        Revenir en arrière
                    </a>
                    <a class="next-btn" href="{% url 'search_view' %}?{{ querystring }}">
                        Passer cette étape
                    </a>
                </div>
            </div>
        </section>
    </div>
</div>
<div class="modal-backdrop show"></div>
{% endblock %}

{% block extra_css %}
{% compress css %}
<link rel="stylesheet" href="/static/css/select2.scss" type="text/x-scss" charset="utf-8">
{% endcompress %}
{% endblock %}

{% block extra_js %}
{% compress js %}
<script src="/static/select2/dist/js/select2.js"></script>
<script src="/static/select2/dist/js/i18n/fr.js"></script>
<script src="/static/js/search/project_step_bg.js"></script>
<script src="/static/js/search/track_project_step_events.js"></script>
<script src="/static/js/aids/project_autocomplete.js"></script>
{% endcompress %}
{% endblock %}
