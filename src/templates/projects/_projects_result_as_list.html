{% load i18n humanize projects%}

{% if projects %}
<div class="fr-table" id="project_in_list">
    <table title="Liste des projets subventionnés">
        <caption class="fr-sr-only">
            Liste des projets subventionnés
        </caption>
        <thead>
            <tr>
                <th scope="col">Distance</th>
                <th scope="col">Année</th>
                <th scope="col">Mairie</th>
                <th scope="col">Projet</th>
                <th scope="col">Aide</th>
                <th scope="col">Coût total</th>
                <th scope="col">Subvention accordée</th>
            </tr>
        </thead>
        <tbody>
            {% for project in projects %}
            <tr>
                <td>{{ project.organization.perimeter }}</td>
                <td>{{ project.date_obtained|date:"Y"}}</td>
                <td>{{ project.organization.name }}</td>
                <td>
                    {% if project.project_linked %}
                    <a href="{% url 'public_project_detail_view' project.project_linked.pk project.project_linked.slug %}">
                    {{ project.project_linked.name }}
                    </a>
                    {% else %}
                    {{ project.project_name }}
                    {% endif %}
                </td>
                <td>
                    {% if project.aid_linked %}
                    <a href="{% url 'aid_detail_view' project.aid_linked.slug %}">
                        {{ project.aid_linked.name}}
                    </a>
                    {% else %}
                    {{ project.aid_name }}
                    {% endif %}
                </td>
                <td>{{ project.budget|intcomma }} €</td>
                <td>
                    {% if project.amount_obtained %}
                    {{ project.amount_obtained|intcomma }} €
                     ({% budget_percentage project project.amount_obtained %}%)
                    {% else %}
                    inconnu
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
